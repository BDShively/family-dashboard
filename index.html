<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Sign in</title>
<link rel="stylesheet" href="/family-dashboard/css/base.css">
<style>
  :root{--bg:#0b1220;--bg2:#0f1a2b;--card:#111832;--muted:#9db1d1;--fg:#e6eefc}
  body{margin:0;font-family:Inter,system-ui;display:grid;place-items:center;min-height:100vh;
       background:linear-gradient(160deg,var(--bg),var(--bg2));color:var(--fg)}
  .card{width:min(420px,92vw);background:var(--card);border:1px solid #2b325a;border-radius:16px;padding:18px}
  h1{margin:0 0 8px}
  .muted{color:var(--muted);font-size:12px;margin-bottom:12px}
  .row{display:grid;grid-template-columns:1fr;gap:10px;margin:10px 0}
  input{width:100%;padding:10px;border:1px solid #2b325a;border-radius:10px;background:#0f1330;color:#e6eefc}
  .btn{width:100%;padding:10px;border:1px solid #2b325a;border-radius:10px;background:#0f1330}
  .split{display:flex;gap:8px}
</style>
</head>
<body>
  <div class="card">
    <h1>Sign in</h1>
    <div class="muted">Use Google or email + password.</div>

    <button id="google" class="btn">Continue with Google</button>

    <div class="row">
      <input id="email" type="email" placeholder="you@example.com">
      <input id="pass" type="password" placeholder="Password">
      <div class="split">
        <button id="emailSignIn" class="btn">Sign in</button>
        <button id="emailRegister" class="btn">Register</button>
      </div>
    </div>

    <div id="msg" class="muted"></div>
  </div>

<script type="module">
  import { auth, onAuthStateChanged } from "/family-dashboard/js/firebase-init.js";
  import {
    GoogleAuthProvider, signInWithPopup,
    signInWithEmailAndPassword, createUserWithEmailAndPassword
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

  // If already signed in, go to dashboard
  onAuthStateChanged(auth, u => { if(u) location.href = "/family-dashboard/index.html"; });

  const msg = (t)=> document.getElementById('msg').textContent = t || "";

  document.getElementById('google').onclick = async ()=>{
    try{
      await signInWithPopup(auth, new GoogleAuthProvider());
      location.href="/family-dashboard/index.html";
    }catch(e){ msg(e.message); }
  };

  document.getElementById('emailSignIn').onclick = async ()=>{
    const email = document.getElementById('email').value.trim();
    const pass  = document.getElementById('pass').value;
    try{
      await signInWithEmailAndPassword(auth, email, pass);
      location.href="/family-dashboard/index.html";
    }catch(e){ msg(e.message); }
  };

  document.getElementById('emailRegister').onclick = async ()=>{
    const email = document.getElementById('email').value.trim();
    const pass  = document.getElementById('pass').value;
    try{
      await createUserWithEmailAndPassword(auth, email, pass);
      location.href="/family-dashboard/index.html";
    }catch(e){ msg(e.message); }
  };
</script>
</body>
</html>
